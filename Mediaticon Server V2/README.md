# **MEDIATICON™ SERVER V2 - GUIDE**
***Important:*** all sources contained in this repository are part of Mediaticon™ Project. These were deployed by Mediaticon™ Developers Team. *Sharing any part of this project, without asking permission to each project's developers and members, are highly PROHIBITED. **Any illegal action, and any agreement violation, will be punished.***

-------------------------------------------------------------------------------------

## About authors:
This part of the project was deployed by **Cristian Capraro**, with the grateful, and helpful support of **Giovanni Bellini**, **Emanuele Trento** and **Simone Destro**.

Our Website and GitHub profile are listed below:

[Cristian's - Website](https://me.cristiancrazy.it)

[Visual Laser 10 New - Website](https://sites.google.com/view/visuallaser10/)

[Cristian's - GitHub](https://www.github.com/cristiancrazy)


[Visual Laser 10 New - GitHub](https://github.com/visuallaser10new/)

[Giova-Bell - GitHub](https://github.com/Giova-Bell)

[Simone Il Navy - GitHub](https://github.com/simoneilnavy/)

-------------------------------------------------------------------------------------

## MD Server - Install Dependencies
Before running MD Server, you must install the Java's and Python's dependencies. These could be installed in two different way:
1. The **easy way**: run the **dependencies installer scripts**, which are available for Windows, and Linux based systems (Debian or Ubuntu are suggested). These are available for the following system's architectures: 
    - x86
    - AMD64
    - ARM

2. The **hardest way**: check manually **Python 3 requirements**, and install them. You must also have installed a supported JVM (**requires at least Java 17 LTS**). Suggested VM (available for a bunch of different OS and architecture): [Liberica JVM](https://www.bell-sw.com).

### Dependencies on Windows 10/11 (requires reboot)
If you choose to install dependencies with the available scripts, you must have **administrative privileges** and you must have also already installed **at least PowerShell 6.0**.

Before running these scripts, you must **run PS with administrative privileges**, and you must set **the execution policy** to **bypass** for the current process, with the following command. 

`Set-ExecutionPolicy Bypass Process`

Then you must navigate in the **dependencies folder** (with CDs commands) and run scripts from there:


`.\Dependencies_installer_Windows-OS-base.ps1`

`.\Dependencies_installer_Windows-OS-pyLibs.ps1`

**Remember to follow the installations procedures which will be displayed after running these scripts.**

***Important:*** *During Python installation, you must check the box called "ADD PYTHON TO PATH".*

### Dependencies on Ubuntu or Debian 9/10/11 (recommended reboot)
If you choose to install dependencies with the available script, you must have **administrative privileges**. Open terminal if you're in a graphical environment, reach the **dependencies folder** (with CDs commands) and run the installation script from there (then, please, follow the wizard):

`sh ./Dependencies_installer_Debian-OS.sh`

-------------------------------------------------------------------------------------
## **MD SERVER V2.0 - Default Directories**
When you've installed all the dependencies, you will be able to start the MD Server and run the scraper programs. In the repository you will find an easy directories organization, but you're free to use every directories configuration you want.

The default directories configuration is shown below:
| Directory      | Description |
| -------------- | ----------- |
| config         | This folder is used to store configurations (global server config, application process config, planning, etc...)       |
| logs           | This folder is used to store debug information (process failed informations, applications outputs, etc...)|
| output         | This folder contains output files generated by the scrapers programs|
| pyexe          | This folder contains the scraper programs (thanks to Giovanni Bellini's work)|

-------------------------------------------------------------------------------------
## **MD SERVER V2.0 - PRECONFIGURATION**
You must setup your server with the appropriate configuration, before starting it up.
The configuration file required, in **.json format**, are 3:
- **Global configuration file** (the most important)
- **Application process configuration file** (the second most important)
- **The Server configuration Planning** (you can start server without this, but it will be closed immediately because it hasn't any idea of what action it has to perform).
### **MD SERVER - GLOBAL CONFIGURATION FILE**
It is a **.json** formatted file, with the following properties:
|Property        | Type        | Description        |
|----------------|-------------|--------------------|
|App Config File |Path string  | Specify the path of the **Application Process configuration file**        |
|Time Plan File  |Path string  | Specify the path of the **Server Planning configuration file**        |
| App Folder     |Path string  | Specify the directory's path where the **scraper applications** are stored        |
| Output Folder  |Path string  | Specify the directory's path where the **generated output** will be stored        |
| Log Folder     |Path string  | Specify the directory's path where the **debug informations** will be stored        |
| FTP Service    |Boolean      | It's a flag which specify to the server to **enable the FTP forwarding output service**      |
| FTP Server     |URI string   | If the FTP Service is set on *true*, you must specify the address of the FTP Server (otherwise, you could set it to *null*)        |
| FTP Port     | Integer      | If the FTP Service is set on *true*, you must specify the port of the FTP Server (it could also be set to *null* - the server will automatically use the port *21*)        |
| FTP Username | UTF-8 String | If the FTP Service is set on *true*, you must specify the Username to access the FTP Server (otherwise, set it to *null*)         |
| FTP Password | UTF-8 String | If the FTP Service is set on *true*, you must specify the Password to access the FTP Server (otherwise, set it to *null*)         |

**Config example (config.json)**
```
{
  "App Config File": "./config/appconfig.json",
  "Time Plan File": "./config/plan2.json",

  "App Folder": "./pyexe",
  "Output Folder": "./output",
  "Log Folder": "./logs",

  "FTP Service": true,
  "FTP Server": "files.ftpwebsite.com",
  "FTP Port": 21,
  "FTP Username": "yourUsername",
  "FTP Password": "yourPassword"
}
```
-------------------------------------------------------------------------------------

### **MD SERVER - APPLICATION PROCESS CONFIGURATION FILE**
It is a **.json array** formatted file, with the following properties:
|Property        | Type               | Description        |
|----------------|--------------------|--------------------|
| App Name       | Filename string    | It must specify the filename of a scraper program         |
| Params         | .json string array | It's a json string array, you must specify here the argument used to start the scraper program.         |

The **Params** property must follow some rules:
- The last parameter must be the **Output directory + Filename**.
- You must use special tags to specify the YEAR to harvest, and to abbreviate the OUTPUT path:
    | Tag        | Description |
    |------------|-------------|
    | `@YEAR`    | This tags, during the execution, will be replaced with the planned year.        |
    | `@OUTPUT`    | This tags, during the execution, will be replaced with the correct output folder.        |

**Config example (appconfig.json)**
```
[
  {
    "App Name": "movies_scraping.py",
    "Params": ["-y", "@YEAR", "-p", "@OUTPUT/Film/Film_@YEAR.json"]
  },
  {
    "App Name": "TVseries_scraping.py",
    "Params": ["-y", "@YEAR", "-p", "@OUTPUT/Serie/Serie_@YEAR.json"]
  },
  {
    "App Name": "anime_scraping.py",
    "Params": ["-y", "@YEAR", "-p", "@OUTPUT/Anime/Anime_@YEAR.json"]
  }
]
```
-------------------------------------------------------------------------------------

### **MD SERVER - SERVER CONFIGURATION PLANNING FILE**
It is a **.json array** formatted file, with the following properties:

|Property        | Type               | Description        |
|----------------|--------------------|--------------------|
| ID             | Integer            | Is an Identifier Number, and it is used to organize the execution. This number **must be unique**. You can't reuse the same number (maximum single plan: 65.536)        |
| App Name       | Filename string    | It must specify the name of the scraper application which refers that plan        |
| Year        | Integer               | It must specify the year which will be scraped for that plan        |
| Start Time         | Formatted string | Specify the time of the day to start that plan. Format: `"HH:mm"` (where *HH* means a value of 0 <-> 24, and *mm* means a value of 0 <-> 126)        |
| Start Date         | Formatted string | Specify the date to start that plan. Format: `"DD/MM/YYYY"` (where *DD* means a value of 0 <-> 31, and *MM* means a value of 0 <-> 12, and *YYYY* means a value of 0000 <-> the current year)        |
| Repeat Each        | Formatted string | Specify an amount of time to run repeatedly a scraper. Format: `"TimeAmount TimeUnit"`. Otherwise, if you want to run a scraper a single time, you must specify: `No`.        |
| MidPath            | Path string | Is an *optional field*, it is used with the **FTP Service** to specify a specific directory to upload the *generated output*        |

**Valid ***TimeUnit*** for "Start Date" property:**

|Time Unit        |
|-----------------|
| Minutes         |
| Hours           |
| Days            |
| Weeks           |
| Months          |
| Years           |

**Config example (appconfig.json)**
```
[
  {
    "ID": 1,
    "App Name": "movies_scraping.py",
    "Year": 2019,
    "Start Time": "17:30",
    "Start Date": "16/04/2022",
    "Repeat Each": "200 Minutes",
    "MidPath": "public_html\\csv\\Film"
  },
  {
    "ID": 2,
    "App Name": "movies_scraping.py",
    "Year": 1973,
    "Start Time": "23:50",
    "Start Date": "16/04/2022",
    "Repeat Each": "1 Weeks",
    "MidPath": "public_html/csv/Film"
  }
]
```
-------------------------------------------------------------------------------------

## **MD SERVER V2.0 - CONFIGURATION**
To start the server you must type the following command in a compatible terminal (for a better user experience, the terminal must support colors):

`java -jar ScraperExecutor.jar -c ./config/config.json -l ./config/logo.l`

**Argument description:**
| Argument | Description |
|----------|-------------|
| 1) `-c`     | Is used to specify that the following argument is the config file path |
| 2) `./config/config.json`     | Path to the config file |
| 3) `-l`     | Is used to specify that the following argument is the logo file path (optional) |
| 4) `./config/logo.l`     | Path to the logo file (optional) |

Note: the "logo file" is a properly text file.

-------------------------------------------------------------------------------------
